(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{1527:function(e,t,s){"use strict";(function(e){s("c5e3"),s("921b");i(s("66fd"));var t=i(s("bb1e"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,s("6e42")["createPage"])},2646:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c},o=[];s.d(t,"a",function(){return i}),s.d(t,"b",function(){return o})},"37e1":function(e,t,s){},"9f0c":function(e,t,s){"use strict";(function(e,i,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(s("08d4"));function n(e){return e&&e.__esModule?e:{default:e}}var r={data:function(){return{index:0,username:"",phoneNum:"",password:"",smsCode:"",userFalg:!1,phoneFalg:!1,codeFalg:!1,pwdFalg:!1,isShowPwd:!0,sendCodeText:"发送验证码",timeText:"",num:60,codeTime:"",beginFalg:!1,userobj:{},imgObj:{},system:"",remPwd:{checked:!1},disable:!1,userInfo:{},userValue:""}},onShow:function(){this.system=plus.os.name.toUpperCase(),this.userValue=e.getStorageSync("userValue"),this.userValue?(this.username=this.userValue.userNameStr,this.password=this.userValue.userPwdStr,this.$set(this.remPwd,"checked",this.userValue.pwdFlag)):(this.username="",this.password="",this.$set(this.remPwd,"checked",!1))},methods:{pwd:function(){this.index=0,this.disable=!1,this.userValue?(this.username=this.userValue.userNameStr,this.password=this.userValue.userPwdStr,this.$set(this.remPwd,"checked",this.userValue.pwdFlag)):(this.username=this.username,this.password=this.password,this.$set(this.remPwd,"checked",!1))},code:function(){this.index=1,this.disable=!0,this.$set(this.remPwd,"checked",!1)},checkboxChange:function(e){var t=e.detail.value;t.length>0?this.$set(this.remPwd,"checked",!0):this.$set(this.remPwd,"checked",!1)},swiperChange:function(e){this.index=e.detail.current,this.disable=0!=this.index},checkUser:function(){var t=/^1[3-9]\d{9}$/;return""!=this.username&&t.test(this.username)?(this.userFalg=!0,!0):(e.showToast({title:"请检查手机号",icon:"none",mask:!0}),setTimeout(function(){e.hideToast()},2e3),this.userFalg=!1,!1)},checkPhone:function(){var t=/^1[3-9]\d{9}$/;return""!=this.phoneNum&&t.test(this.phoneNum)?(this.phoneFalg=!0,!0):(e.showToast({title:"请检查手机号",icon:"none",mask:!0}),setTimeout(function(){e.hideToast()},2e3),this.phoneFalg=!1,!1)},checkPwd:function(){var t=/^(?![a-zA-Z]+$)(?![0-9]+$)[A-Za-z0-9]{6,15}$/;return""!=this.password&&t.test(this.password)?(this.pwdFalg=!0,!0):(e.showToast({title:"请输入6-15位的字母数字组合",icon:"none",mask:!0}),setTimeout(function(){e.hideToast()},2e3),this.pwdFalg=!1,!1)},checkCode:function(){return""!=this.smsCode?(this.codeFalg=!0,!0):(this.codeFalg=!1,e.showToast({title:"验证码不能为空",icon:"none",mask:!0}),setTimeout(function(){e.hideToast()},2e3),!1)},showPass:function(){return this.isShowPwd?(this.isShowPwd=!1,!1):(this.isShowPwd=!0,!0)},login:function(){var t=this;if(0===this.index){if(!this.checkUser()||!this.checkPwd())return!1;var s=a.default.MD5(this.password).toString(),n=new i(this.username).toString("base64");e.request({url:this.websiteUrl+"/api/login",method:"POST",data:{mobile:n,userPwd:s},success:function(s){if(s.data&&0===s.data.status){t.remPwd.checked?(t.userInfo={userNameStr:t.username,userPwdStr:t.password,pwdFlag:t.remPwd.checked},e.setStorageSync("userValue",t.userInfo)):e.removeStorageSync("userValue");var a=s.data,n=new i(a.user.userPhone,"base64").toString("utf8");if(t.userobj.userPhone=n,t.userobj.userName=a.user.userNickName,t.userobj.userCode=a.user.userInvite,t.userobj.userId=parseInt(a.user.userId),t.userobj.loginToken=a.token,null==a.user.userBlurb?t.userobj.userText="":t.userobj.userText=a.user.userBlurb,""==a.user.userPortrait)t.imgObj.networkImage="",t.imgObj.localImage="/static/touxiang.png",t.$store.commit("storeImage",t.imgObj),t.$store.commit("login",t.userobj),e.navigateBack();else{t.imgObj.networkImage=t.websiteUrl+"/"+a.user.userPortrait;var r=t,u=r.$store.state.userImage.localImage;u&&""!=u&&"/static/touxiang.png"!=u&&e.removeSavedFile({filePath:u,success:function(e){console.log(o(e," at pages\\login\\login.vue:272"))}}),e.downloadFile({url:r.imgObj.networkImage,success:function(t){var s=t.tempFilePath,i=t.statusCode;200==i?e.saveFile({tempFilePath:s,success:function(t){var s=t.savedFilePath;r.imgObj.localImage=s,r.$store.commit("storeImage",r.imgObj),r.$store.commit("login",r.userobj),e.navigateBack()}}):(r.imgObj.localImage="/static/touxiang.png",r.$store.commit("storeImage",r.imgObj),r.$store.commit("login",r.userobj),e.navigateBack())}})}}else e.showToast({title:s.data.message,icon:"none",mask:!0}),setTimeout(function(){e.hideToast()},2e3)},fail:function(){},complete:function(){}})}else{if(!this.checkPhone()||!this.checkCode())return!1;var r=new i(this.phoneNum).toString("base64");e.request({url:this.websiteUrl+"/api/loginsms",method:"POST",data:{mobile:r,smsCode:this.smsCode},success:function(s){if(s.data&&0===s.data.status){var o=s.data,a=new i(o.user.userPhone,"base64").toString("utf8");if(t.userobj.userPhone=a,t.userobj.userName=o.user.userNickName,t.userobj.userCode=o.user.userInvite,t.userobj.userId=parseInt(o.user.userId),t.userobj.loginToken=o.token,null==o.user.userBlurb?t.userobj.userText="":t.userobj.userText=o.user.userBlurb,""==o.user.userPortrait)t.imgObj.networkImage="",t.imgObj.localImage="/static/touxiang.png",t.$store.commit("storeImage",t.imgObj),t.$store.commit("login",t.userobj),e.navigateBack();else{t.imgObj.networkImage=t.websiteUrl+"/"+o.user.userPortrait;var n=t,r=n.$store.state.userImage.localImage;r&&""!=r&&"/static/touxiang.png"!=r&&e.removeSavedFile({filePath:r}),e.downloadFile({url:n.imgObj.networkImage,success:function(t){var s=t.tempFilePath,i=t.statusCode;200==i?e.saveFile({tempFilePath:s,success:function(t){var s=t.savedFilePath;n.imgObj.localImage=s,n.$store.commit("storeImage",n.imgObj),n.$store.commit("login",n.userobj),e.navigateBack()}}):(n.imgObj.localImage="/static/touxiang.png",n.$store.commit("storeImage",n.imgObj),n.$store.commit("login",n.userobj),e.navigateBack())}})}}else e.showToast({title:s.data.message,icon:"none",mask:!0}),setTimeout(function(){e.hideToast()},2e3)},fail:function(){},complete:function(){}})}},sendCode:function(){var t=/^1[3-9]\d{9}$/;if(""==this.phoneNum||!t.test(this.phoneNum))return e.showToast({title:"请检查手机号",icon:"none",mask:!0}),setTimeout(function(){e.hideToast()},2e3),!1;this.codeTime=setInterval(this.countDown,1e3);var s=new i(this.phoneNum).toString("base64");e.request({url:this.websiteUrl+"/api/code/sms",method:"POST",data:{mobile:s},success:function(e){console.log(o(e," at pages\\login\\login.vue:423"))},fail:function(){},complete:function(){}})},countDown:function(){this.num--,this.beginFalg=!0,this.timeText=this.num+"s",this.num<=0&&(this.num=60,this.timeText="",this.beginFalg=!1,clearInterval(this.codeTime))}}};t.default=r}).call(this,s("6e42")["default"],s("b639").Buffer,s("0de9")["default"])},bb1e:function(e,t,s){"use strict";s.r(t);var i=s("2646"),o=s("cfed");for(var a in o)"default"!==a&&function(e){s.d(t,e,function(){return o[e]})}(a);s("e9ef");var n=s("2877"),r=Object(n["a"])(o["default"],i["a"],i["b"],!1,null,null,null);t["default"]=r.exports},cfed:function(e,t,s){"use strict";s.r(t);var i=s("9f0c"),o=s.n(i);for(var a in i)"default"!==a&&function(e){s.d(t,e,function(){return i[e]})}(a);t["default"]=o.a},e9ef:function(e,t,s){"use strict";var i=s("37e1"),o=s.n(i);o.a}},[["1527","common/runtime","common/vendor"]]]);