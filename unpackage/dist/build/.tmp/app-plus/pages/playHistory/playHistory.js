(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/playHistory/playHistory"],{7715:function(t,e,s){"use strict";s.r(e);var l=s("c141"),i=s("a208");for(var a in i)"default"!==a&&function(t){s.d(e,t,function(){return i[t]})}(a);s("cf01");var r=s("2877"),o=Object(r["a"])(i["default"],l["a"],l["b"],!1,null,null,null);e["default"]=o.exports},a208:function(t,e,s){"use strict";s.r(e);var l=s("df1b"),i=s.n(l);for(var a in l)"default"!==a&&function(t){s.d(e,t,function(){return l[t]})}(a);e["default"]=i.a},c141:function(t,e,s){"use strict";var l=function(){var t=this,e=t.$createElement;t._self._c},i=[];s.d(e,"a",function(){return l}),s.d(e,"b",function(){return i})},cf01:function(t,e,s){"use strict";var l=s("f08d"),i=s.n(l);i.a},df1b:function(t,e,s){"use strict";(function(t,s){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var l={data:function(){return{isCancel:!1,num:0,isSelect:!1,allSelect:"全选",selectedId:0,selectedArr:[],historyArr:[],localArr:[],localSelect:[],localNum:0}},methods:{changeCheckbox:function(t){var e=this.localArr,s=t.detail.value;this.localNum=s.length,this.localSelect=s;for(var l=0,i=e.length;l<i;++l){var a=e[l],r=a.vodId.toString();s.includes(r)?this.$set(a,"checked",!0):this.$set(a,"checked",!1)}var o=this.localNum+this.num,n=e.length+this.historyArr.length;this.allSelect=o<n?"全选":"取消全选"},toMovie:function(e){var s=e.currentTarget.id;this.isCancel||t.navigateTo({url:"/pages/playPage/playPage?vodId="+s,animationType:"slide-in-right"})},checkboxChange:function(t){var e=this.historyArr,s=t.detail.value;this.num=s.length,this.selectedArr=s;for(var l=0,i=e.length;l<i;++l){var a=e[l],r=a.recordId.toString();s.includes(r)?this.$set(a,"checked",!0):this.$set(a,"checked",!1)}var o=this.localNum+this.num,n=this.localArr.length+e.length;this.allSelect=o<n?"全选":"取消全选"},all_select:function(){var t=this.historyArr,e=this.localArr;if(!(t.length<=0&&e.length<=0))if(this.isSelect){if(this.num<t.length&&e.length<=0){this.num=t.length,this.selectedArr=[];for(var s=0,l=t.length;s<l;++s){var i=t[s];this.$set(i,"checked",!0),this.selectedArr.push(i.recordId.toString())}return void(this.allSelect="取消全选")}if(this.localNum<e.length&&t.length<=0){this.localNum=e.length,this.localSelect=[];for(var a=0,r=e.length;a<r;++a){var o=e[a];this.$set(o,"checked",!0),this.localSelect.push(o.vodId.toString())}return void(this.allSelect="取消全选")}if(this.localNum<e.length||this.num<t.length){this.localNum=e.length,this.num=t.length,this.selectedArr=[],this.localSelect=[];for(var n=0,c=e.length;n<c;++n){var h=e[n];this.$set(h,"checked",!0),this.localSelect.push(h.vodId.toString())}for(var u=0,d=t.length;u<d;++u){var f=t[u];this.$set(f,"checked",!0),this.selectedArr.push(f.recordId.toString())}return void(this.allSelect="取消全选")}for(var g=0,v=t.length;g<v;++g){var p=t[g];this.$set(p,"checked",!1)}for(var y=0,S=e.length;y<S;++y){var m=e[y];this.$set(m,"checked",!1)}this.num=0,this.localNum=0,this.isSelect=!1,this.allSelect="全选",this.selectedArr=[],this.localSelect=[]}else{this.selectedArr=[],this.localSelect=[];for(var A=0,b=t.length;A<b;++A){var N=t[A];this.$set(N,"checked",!0),this.selectedArr.push(N.recordId.toString())}for(var k=0,$=e.length;k<$;++k){var I=e[k];this.$set(I,"checked",!0),this.localSelect.push(I.vodId.toString())}this.num=t.length,this.localNum=e.length,this.isSelect=!0,this.allSelect="取消全选"}},deleteItem:function(){var e=this,l=this;if(this.selectedArr.length>0){this.selectedArr=JSON.stringify(this.selectedArr);var i=this.$store.state.userInfo.loginToken;t.request({url:this.websiteUrl+"/user/del/visit",header:{Authorization:i},method:"POST",data:{visitIdArray:this.selectedArr},success:function(t){if(t.data){JSON.parse(e.selectedArr,function(t,e){for(var s=l.historyArr,i=0;i<s.length;i++)s[i].recordId==e&&s.splice(i,1)});var s=l.$mp.page.$getAppWebview();s.setStyle({titleNView:{autoBackButton:!0}}),s.setTitleNViewButtonStyle(0,{text:"编辑"}),l.isCancel=!1}},fail:function(){},complete:function(){}})}if(this.localSelect.length>0){var a=JSON.stringify(this.localSelect),r=a.replace("[","(").replace("]",")");plus.sqlite.executeSql({name:"98TV",sql:"delete from history where vodId in "+r,success:function(t){console.log(s("executeSql success!"," at pages\\playHistory\\playHistory.vue:239")),JSON.parse(a,function(t,e){for(var s=l.localArr,i=0;i<s.length;i++)s[i].vodId==e&&s.splice(i,1)});var e=l.$mp.page.$getAppWebview();e.setStyle({titleNView:{autoBackButton:!0}}),e.setTitleNViewButtonStyle(0,{text:"编辑"}),l.isCancel=!1},fail:function(t){console.log(s("executeSql failed: "+JSON.stringify(t)," at pages\\playHistory\\playHistory.vue:256"))}})}},isOpen:function(){var t;return t=plus.sqlite.isOpenDatabase({name:"98TV",path:"_doc/test.db"}),!!t},selectSql:function(){var t=this;this.isOpen()||plus.sqlite.openDatabase({name:"98TV",path:"_doc/test.db",success:function(t){console.log(s("openDatabase success!"," at pages\\playHistory\\playHistory.vue:284"))},fail:function(t){console.log(s("openDatabase failed: "+JSON.stringify(t)," at pages\\playHistory\\playHistory.vue:287"))}}),plus.sqlite.selectSql({name:"98TV",sql:"select * from history",success:function(e){console.log(s("selectSql success: "," at pages\\playHistory\\playHistory.vue:295")),e.length>0&&(t.localArr=e)},fail:function(t){console.log(s("selectSql failed: "+JSON.stringify(t)," at pages\\playHistory\\playHistory.vue:301"))}})}},onNavigationBarButtonTap:function(){var t=this.$mp.page.$getAppWebview();if(this.isCancel){t.setStyle({titleNView:{autoBackButton:!0}}),t.setTitleNViewButtonStyle(0,{text:"编辑"}),this.isCancel=!1,this.num=0,this.localNum=0,this.isSelect=!1,this.allSelect="全选";for(var e=0,s=this.historyArr.length;e<s;++e){var l=this.historyArr[e];this.$set(l,"checked",!1)}for(var i=0,a=this.localArr.length;i<a;++i){var r=this.localArr[i];this.$set(r,"checked",!1)}}else t.setStyle({titleNView:{autoBackButton:!1}}),t.setTitleNViewButtonStyle(0,{text:"取消"}),this.isCancel=!0},onShow:function(){var e=this;if(this.selectSql(),this.$store.state.isLogin){var s=this.$store.state.userInfo.userId,l=this.$store.state.userInfo.loginToken;t.request({url:this.websiteUrl+"/user/get/visit",method:"GET",header:{Authorization:l},data:{userId:s},success:function(s){if(1001==s.data.status)return t.showToast({title:s.data.message,icon:"none",mask:!0}),void setTimeout(function(){t.hideToast(),t.navigateTo({url:"/pages/login/login",animationType:"slide-in-bottom"})},800);if(s.data.length>0){e.historyArr=s.data;for(var l=0;l<e.historyArr.length;l++)for(var i=0;i<e.localArr.length;i++)e.localArr[i].vodId==e.historyArr[l].vodId&&e.localArr.splice(i,1)}},fail:function(){},complete:function(){}})}},onBackPress:function(){this.isOpen()&&plus.sqlite.closeDatabase({name:"98TV",success:function(t){console.log(s("closeDatabase success!"," at pages\\playHistory\\playHistory.vue:389"))},fail:function(t){console.log(s("closeDatabase failed: "+JSON.stringify(t)," at pages\\playHistory\\playHistory.vue:392"))}})}};e.default=l}).call(this,s("6e42")["default"],s("0de9")["default"])},ec2c:function(t,e,s){"use strict";(function(t){s("c5e3"),s("921b");l(s("66fd"));var e=l(s("7715"));function l(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,s("6e42")["createPage"])},f08d:function(t,e,s){}},[["ec2c","common/runtime","common/vendor"]]]);